# Google Apps Script設定手順書

## 1. Googleスプレッドシートの作成

### 手順1: スプレッドシート作成
1. [Google Sheets](https://sheets.google.com)にアクセス
2. 「空白」をクリックして新しいスプレッドシートを作成
3. ファイル名を「AIアンケート回答データ」に変更

### 手順2: ヘッダー設定
A1セルから以下を入力：
- A1: `タイムスタンプ`
- B1: `名前`
- C1: `一番使うAI`
- D1: `AIの使い方`

## 2. Google Apps Scriptの設定

### 手順1: Apps Script開く
1. スプレッドシートで「拡張機能」→「Apps Script」をクリック
2. 新しいタブでApps Scriptエディタが開く

### 手順2: コードを貼り付け
1. デフォルトの`myFunction`を削除
2. `google-apps-script.js`の内容をすべてコピー＆ペースト
3. **重要**: 2行目の`YOUR_SPREADSHEET_ID_HERE`をスプレッドシートIDに置き換え

#### スプレッドシートIDの取得方法
スプレッドシートのURLから取得：
```
https://docs.google.com/spreadsheets/d/【ここがスプレッドシートID】/edit
```

### 手順3: 初期化実行（任意）
1. 関数選択で`initializeSpreadsheet`を選択
2. 「実行」ボタンをクリック
3. 権限の許可を求められたら「許可」をクリック

## 3. Webアプリとして公開

### 手順1: デプロイ設定
1. 「デプロイ」ボタンをクリック
2. 「新しいデプロイ」を選択
3. 設定項目：
   - **種類**: ウェブアプリ
   - **説明**: AIアンケートフォーム（任意）
   - **実行ユーザー**: 自分
   - **アクセスできるユーザー**: 全員

### 手順2: デプロイ実行
1. 「デプロイ」ボタンをクリック
2. 権限の承認を行う
3. **WebアプリのURL**をコピー（重要）

## 4. HTMLフォームの更新

### 手順1: URLの更新
1. `index.html`を開く
2. 77行目の`YOUR_GOOGLE_APPS_SCRIPT_URL_HERE`を手順3-2で取得したURLに置き換え

```javascript
// 変更前
const SCRIPT_URL = 'YOUR_GOOGLE_APPS_SCRIPT_URL_HERE';

// 変更後（例）
const SCRIPT_URL = 'https://script.google.com/macros/s/AK...../exec';
```

## 5. 動作確認

### 手順1: テスト送信
1. `index.html`をブラウザで開く
2. テストデータを入力して送信
3. スプレッドシートにデータが追加されることを確認

### 手順2: エラー確認
問題が発生した場合：
1. Apps Scriptの「実行数」タブでエラーログを確認
2. ブラウザの開発者ツールでコンソールエラーを確認

## 6. セキュリティ設定（推奨）

### CORS設定
- 現在の設定では全てのドメインからアクセス可能
- 本番環境では特定ドメインのみ許可することを推奨

### データ保護
- スプレッドシートの共有設定を適切に設定
- 必要に応じてフォームの公開範囲を制限

## 7. トラブルシューティング

### よくある問題
1. **「権限がありません」エラー**
   - Apps Scriptの実行権限を再度確認
   - Googleアカウントの2段階認証設定を確認

2. **フォーム送信後に反応がない**
   - WebアプリURLが正しく設定されているか確認
   - ブラウザのコンソールでエラーメッセージを確認

3. **データがスプレッドシートに保存されない**
   - スプレッドシートIDが正しいか確認
   - Apps Scriptの実行ログを確認

### ログの確認方法
1. Apps Scriptエディタで「実行数」タブを開く
2. 最近の実行を選択してログを確認

## 8. 運用開始

設定完了後：
1. `index.html`をWebサーバーにアップロード
2. または直接ブラウザで開いて使用
3. スプレッドシートでリアルタイムにデータを確認可能